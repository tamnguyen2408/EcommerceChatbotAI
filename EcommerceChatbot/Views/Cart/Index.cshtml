@model List<ECommerceChatbot.Models.CartItem>

@{
    ViewData["Title"] = "Cart";
    Layout = "~/Views/Shared/_Layout.cshtml"; // Tham chiếu tới layout chính
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="~/css/cart.css" />
</head>
<body>

    <header>
        <div class="container">
            <h1>Style O</h1>
            <nav>
                <a asp-action="Index" asp-controller="User">Home</a>
                <a asp-action="Index" asp-controller="Cart" class="active">Cart</a>
                <a asp-action="Index" asp-controller="Checkout">Checkout</a>
            </nav>
        </div>
    </header>

    <main>
        <div class="cart-container">
            <h2>Your Shopping Cart</h2>
            <table class="cart-table">
                <thead>
                    <tr>
                        <th>Product Name</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.Any())
                    {
                        foreach (var item in Model)
                        {
                            <tr>
                                <td>@item.ProductName</td>
                                <td>@item.Price.ToString("C")</td> <!-- Hiển thị đúng giá tiền -->
                                <td>
                                    <form method="post" asp-action="UpdateQuantity" asp-controller="Cart">
                                        @Html.AntiForgeryToken()
                                        <input type="hidden" name="productId" value="@item.ProductId" />
                                        <input type="number" name="quantity" value="@item.Quantity" min="1" />
                                        <button type="submit" class="update-btn">Update</button>
                                    </form>
                                </td>
                                <td>
                                    <form method="post" asp-action="RemoveFromCart" asp-controller="Cart">
                                        @Html.AntiForgeryToken()
                                        <input type="hidden" name="productId" value="@item.ProductId" />
                                        <button type="submit" class="remove-btn">Remove</button>
                                    </form>
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="4" class="empty-cart-message">Your cart is currently empty.</td>
                        </tr>
                    }
                </tbody>
            </table>

            @if (Model != null && Model.Any())
            {
                <div class="cart-total">
                    <p>
                        <strong>Total: </strong>
                        @(Model != null && Model.Any() ? Model.Sum(item => item.Price * item.Quantity).ToString("C") : "$0.00")
                    </p>
                    <form method="get" asp-action="Checkout" asp-controller="Cart">
                        <button type="submit" class="checkout-btn">Proceed to Payment</button>
                    </form>
                </div>
            }
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 Shopping Online.</p>
        </div>
    </footer>
</body>
</html>
